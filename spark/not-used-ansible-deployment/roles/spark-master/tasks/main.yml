

- name: "Stop Master"
  command: ./sbin/stop-master.sh
  args:
          chdir: /usr/local/spark/
  become: yes # needed to write log files?

- name: "Kill outstanding Spark processes"
  shell: |
    kill -s KILL $(lsof -t -i :4040 -sTCP:LISTEN)
    kill -s KILL $(lsof -t -i :4041 -sTCP:LISTEN)
    kill -s KILL $(lsof -t -i :4042 -sTCP:LISTEN)
    kill -s KILL $(lsof -t -i :4043 -sTCP:LISTEN)
    kill -s KILL $(lsof -t -i :4044 -sTCP:LISTEN)
    kill -s KILL $(lsof -t -i :4045 -sTCP:LISTEN)
    kill -s KILL $(lsof -t -i :4046 -sTCP:LISTEN)
    kill -s KILL $(lsof -t -i :4047 -sTCP:LISTEN)
    kill -s KILL $(lsof -t -i :4048 -sTCP:LISTEN)
    exit 0
  args:
    executable: /bin/bash


- name: "Start Master"
  command: ./sbin/start-master.sh
  args:
          chdir: /usr/local/spark/
  become: yes # needed to write log files?

